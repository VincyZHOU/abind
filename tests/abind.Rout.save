

> library(abind)
> # unlike cbind or rbind
> abind(x=1:4,y=5:8)
x1 x2 x3 x4 y1 y2 y3 y4 
 1  2  3  4  5  6  7  8 
> # like cbind
> abind(x=1:4,y=5:8,along=2)                   
     x y
[1,] 1 5
[2,] 2 6
[3,] 3 7
[4,] 4 8
> abind(x=1:4,matrix(5:20,nrow=4),along=2)
     x matrix(5:20, nrow = 4)1 matrix(5:20, nrow = 4)2 matrix(5:20, nrow = 4)3
[1,] 1                       5                       9                      13
[2,] 2                       6                      10                      14
[3,] 3                       7                      11                      15
[4,] 4                       8                      12                      16
     matrix(5:20, nrow = 4)4
[1,]                      17
[2,]                      18
[3,]                      19
[4,]                      20
> abind(1:4,matrix(5:20,nrow=4),along=2)
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    5    9   13   17
[2,]    2    6   10   14   18
[3,]    3    7   11   15   19
[4,]    4    8   12   16   20
> # like rbind
> abind(x=1:4,matrix(5:20,nrow=4),along=1)
                        [,1] [,2] [,3] [,4]
x                          1    2    3    4
matrix(5:20, nrow = 4)1    5    9   13   17
matrix(5:20, nrow = 4)2    6   10   14   18
matrix(5:20, nrow = 4)3    7   11   15   19
matrix(5:20, nrow = 4)4    8   12   16   20
> abind(1:4,matrix(5:20,nrow=4),along=1)
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    9   13   17
[3,]    6   10   14   18
[4,]    7   11   15   19
[5,]    8   12   16   20
> # different default dimnames:
> abind(x=1:4,matrix(5:20,nrow=4),along=1)
                        [,1] [,2] [,3] [,4]
x                          1    2    3    4
matrix(5:20, nrow = 4)1    5    9   13   17
matrix(5:20, nrow = 4)2    6   10   14   18
matrix(5:20, nrow = 4)3    7   11   15   19
matrix(5:20, nrow = 4)4    8   12   16   20
> abind(x=1:4,matrix(5:20,nrow=4),along=1,force.array=F)
  [,1] [,2] [,3] [,4]
x    1    2    3    4
     5    9   13   17
     6   10   14   18
     7   11   15   19
     8   12   16   20
> # concatenates two vectors:
> abind(x=1:4,y=5:8)
x1 x2 x3 x4 y1 y2 y3 y4 
 1  2  3  4  5  6  7  8 
> abind(x=c(a=1,b=2),y=3:4)
 a  b y1 y2 
 1  2  3  4 
> abind(x=c(a=1,b=2),y=c(c=3,d=4))
a b c d 
1 2 3 4 
> # simulate rbind with row vectors in three ways:
> # (1) easiest way: insert new dimension before 1 (use any number less than 1 for along)
> abind(x=1:4,y=5:8,along=0.5)
  [,1] [,2] [,3] [,4]
x    1    2    3    4
y    5    6    7    8
> abind(x=c(a=1,b=2),y=c(c=3,d=4), along=0) # with names
  c d
x 1 2
y 3 4
> abind(x=c(a=1,b=2),y=c(c=3,d=4), along=0, use.first.dimnames=T)
  a b
x 1 2
y 3 4
> # (2) permute the result:
> aperm(abind(1:4,5:8,along=2),c(2,1))
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
> # different default dimnames:
> aperm(abind(1:4,5:8,along=2),c(2,1))
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
> # (3) convert arguments to row vectors
> abind(matrix(1:4,nrow=1),matrix(5:8,nrow=1),along=1)
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
> # bind two matrices, 5 possible values for along
> abind(x=matrix(1:16,nrow=4),y=matrix(17:32,nrow=4),along=1)
   [,1] [,2] [,3] [,4]
x1    1    5    9   13
x2    2    6   10   14
x3    3    7   11   15
x4    4    8   12   16
y1   17   21   25   29
y2   18   22   26   30
y3   19   23   27   31
y4   20   24   28   32
> abind(x=matrix(1:16,nrow=4),y=matrix(17:32,nrow=4),along=2)
     x1 x2 x3 x4 y1 y2 y3 y4
[1,]  1  5  9 13 17 21 25 29
[2,]  2  6 10 14 18 22 26 30
[3,]  3  7 11 15 19 23 27 31
[4,]  4  8 12 16 20 24 28 32
> abind(x=matrix(1:16,nrow=4),y=matrix(17:32,nrow=4),along=3)
, , x

     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12   16

, , y

     [,1] [,2] [,3] [,4]
[1,]   17   21   25   29
[2,]   18   22   26   30
[3,]   19   23   27   31
[4,]   20   24   28   32

> abind(x=matrix(1:16,nrow=4),y=matrix(17:32,nrow=4),along=0.5)
, , 1

  [,1] [,2] [,3] [,4]
x    1    2    3    4
y   17   18   19   20

, , 2

  [,1] [,2] [,3] [,4]
x    5    6    7    8
y   21   22   23   24

, , 3

  [,1] [,2] [,3] [,4]
x    9   10   11   12
y   25   26   27   28

, , 4

  [,1] [,2] [,3] [,4]
x   13   14   15   16
y   29   30   31   32

> abind(x=matrix(1:16,nrow=4),y=matrix(17:32,nrow=4),along=1.5)
, , 1

     x  y
[1,] 1 17
[2,] 2 18
[3,] 3 19
[4,] 4 20

, , 2

     x  y
[1,] 5 21
[2,] 6 22
[3,] 7 23
[4,] 8 24

, , 3

      x  y
[1,]  9 25
[2,] 10 26
[3,] 11 27
[4,] 12 28

, , 4

      x  y
[1,] 13 29
[2,] 14 30
[3,] 15 31
[4,] 16 32

> # examples with three matrices
> cc <- as.data.frame(matrix(25:36,nrow=3))
> aa <- matrix(1:12,nrow=3,dimnames=list(letters[1:3],LETTERS[1:4]))
> abind(a=aa, cc, matrix(25:36,3,4), along=0, use.first.dimnames=T)
, , A

                     a  b  c
a                    1  2  3
cc                  25 26 27
matrix(25:36, 3, 4) 25 26 27

, , B

                     a  b  c
a                    4  5  6
cc                  28 29 30
matrix(25:36, 3, 4) 28 29 30

, , C

                     a  b  c
a                    7  8  9
cc                  31 32 33
matrix(25:36, 3, 4) 31 32 33

, , D

                     a  b  c
a                   10 11 12
cc                  34 35 36
matrix(25:36, 3, 4) 34 35 36

> abind(a=aa, cc, matrix(25:36,3,4), along=1, use.first.dimnames=T)
                      A  B  C  D
a                     1  4  7 10
b                     2  5  8 11
c                     3  6  9 12
1                    25 28 31 34
2                    26 29 32 35
3                    27 30 33 36
matrix(25:36, 3, 4)1 25 28 31 34
matrix(25:36, 3, 4)2 26 29 32 35
matrix(25:36, 3, 4)3 27 30 33 36
> abind(a=aa, cc, matrix(25:36,3,4), along=1.1, use.first.dimnames=T)
, , A

  a cc matrix(25:36, 3, 4)
a 1 25                  25
b 2 26                  26
c 3 27                  27

, , B

  a cc matrix(25:36, 3, 4)
a 4 28                  28
b 5 29                  29
c 6 30                  30

, , C

  a cc matrix(25:36, 3, 4)
a 7 31                  31
b 8 32                  32
c 9 33                  33

, , D

   a cc matrix(25:36, 3, 4)
a 10 34                  34
b 11 35                  35
c 12 36                  36

> abind(a=aa, cc, matrix(25:36,3,4), along=2)
  A B C  D V1 V2 V3 V4 matrix(25:36, 3, 4)1 matrix(25:36, 3, 4)2
1 1 4 7 10 25 28 31 34                   25                   28
2 2 5 8 11 26 29 32 35                   26                   29
3 3 6 9 12 27 30 33 36                   27                   30
  matrix(25:36, 3, 4)3 matrix(25:36, 3, 4)4
1                   31                   34
2                   32                   35
3                   33                   36
> abind(a=aa, cc, matrix(25:36,3,4), along=2, use.first.dimnames=T)
  A B C  D V1 V2 V3 V4 matrix(25:36, 3, 4)1 matrix(25:36, 3, 4)2
a 1 4 7 10 25 28 31 34                   25                   28
b 2 5 8 11 26 29 32 35                   26                   29
c 3 6 9 12 27 30 33 36                   27                   30
  matrix(25:36, 3, 4)3 matrix(25:36, 3, 4)4
a                   31                   34
b                   32                   35
c                   33                   36
> abind(a=aa, cc, matrix(25:36,3,4), along=3, use.first.dimnames=T)
, , a

  A B C  D
a 1 4 7 10
b 2 5 8 11
c 3 6 9 12

, , cc

   A  B  C  D
a 25 28 31 34
b 26 29 32 35
c 27 30 33 36

, , matrix(25:36, 3, 4)

   A  B  C  D
a 25 28 31 34
b 26 29 32 35
c 27 30 33 36

> abind(a=aa, cc, matrix(25:36,3,4), along=3, use.anon.names=F, use.first.dimnames=T)
, , a

  A B C  D
a 1 4 7 10
b 2 5 8 11
c 3 6 9 12

, , X2

   A  B  C  D
a 25 28 31 34
b 26 29 32 35
c 27 30 33 36

, , X3

   A  B  C  D
a 25 28 31 34
b 26 29 32 35
c 27 30 33 36

> abind(a=aa, cc, dd=matrix(25:36,3,4), along=1.1, use.first.dimnames=T)
, , A

  a cc dd
a 1 25 25
b 2 26 26
c 3 27 27

, , B

  a cc dd
a 4 28 28
b 5 29 29
c 6 30 30

, , C

  a cc dd
a 7 31 31
b 8 32 32
c 9 33 33

, , D

   a cc dd
a 10 34 34
b 11 35 35
c 12 36 36

> x1 <- array(1:8,dim=c(2,2,2),dimnames=list(letters[6:7],letters[1:2],letters[24:25]))
> x1
, , x

  a b
f 1 3
g 2 4

, , y

  a b
f 5 7
g 6 8

> # test that we get dimnames correctly when we need to expand dimensions
> x2.1 <- array(11:14,dim=c(2,2),dimnames=list(letters[1:2],letters[24:25]))
> x2.2 <- array(11:14,dim=c(2,2),dimnames=list(letters[6:7],letters[24:25]))
> x2.3 <- array(11:14,dim=c(2,2),dimnames=list(letters[6:7],letters[1:2]))
> abind(x1, h=x2.1, along=1)
, , x

   a  b
f  1  3
g  2  4
h 11 12

, , y

   a  b
f  5  7
g  6  8
h 13 14

> abind(x1, c=x2.2, along=2)
, , x

  a b  c
f 1 3 11
g 2 4 12

, , y

  a b  c
f 5 7 13
g 6 8 14

> abind(x1, z=x2.3, along=3)
, , x

  a b
f 1 3
g 2 4

, , y

  a b
f 5 7
g 6 8

, , z

   a  b
f 11 13
g 12 14

> 
> 
